(function(e){function n(n){for(var o,r,c=n[0],s=n[1],u=n[2],l=0,f=[];l<c.length;l++)r=c[l],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&f.push(i[r][0]),i[r]=0;for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o]);d&&d(n);while(f.length)f.shift()();return a.push.apply(a,u||[]),t()}function t(){for(var e,n=0;n<a.length;n++){for(var t=a[n],o=!0,c=1;c<t.length;c++){var s=t[c];0!==i[s]&&(o=!1)}o&&(a.splice(n--,1),e=r(r.s=t[0]))}return e}var o={},i={app:0},a=[];function r(n){if(o[n])return o[n].exports;var t=o[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,r),t.l=!0,t.exports}r.m=e,r.c=o,r.d=function(e,n,t){r.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,n){if(1&n&&(e=r(e)),8&n)return e;if(4&n&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(r.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)r.d(t,o,function(n){return e[n]}.bind(null,o));return t},r.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(n,"a",n),n},r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},r.p="/brewery-town-public/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=n,c=c.slice();for(var u=0;u<c.length;u++)n(c[u]);var d=s;a.push([0,"chunk-vendors"]),t()})({0:function(e,n,t){e.exports=t("cd49")},"0220":function(e,n,t){"use strict";t("ff19")},"1a71":function(e,n,t){"use strict";t("64c6")},"5f35":function(e,n,t){e.exports={publicPath:"/brewery-town-public/"}},"64c6":function(e,n,t){},b3df:function(e,n,t){"use strict";t("fb5c")},cd49:function(e,n,t){"use strict";t.r(n);t("e260"),t("e6cf"),t("cca6"),t("a79d");var o=t("7a23"),i={id:"app"};function a(e,n){var t=Object(o["w"])("router-view");return Object(o["p"])(),Object(o["c"])("div",i,[Object(o["f"])(t)])}t("b3df");const r={};r.render=a;var c=r,s=t("6c02");function u(e,n,t,i,a,r){var c=Object(o["w"])("new-scene");return Object(o["p"])(),Object(o["c"])("div",null,[Object(o["f"])(c)])}var d=t("d4ec"),l=t("262e"),f=t("2caf"),v=t("9ab4"),b=t("ce1f"),p=Object(o["D"])("data-v-549912f1");Object(o["t"])("data-v-549912f1");var y={class:"container"},m={class:"scene",ref:"sceneRef"};Object(o["q"])();var w=p((function(e,n,t,i,a,r){return Object(o["p"])(),Object(o["c"])("div",y,[Object(o["f"])("div",m,null,512)])})),g=(t("a623"),t("7db0"),t("4160"),t("caad"),t("45fc"),t("b0c0"),t("07ac"),t("2532"),t("159b"),t("5a89")),h=t("4721"),j=t("34ad"),O=t("32d9"),x=t("93e9"),z=t("f7dd"),K={setup:function(){var e,n=new g["Cb"]({antialias:!0}),t=new g["jb"],i=new g["i"],a=new g["hb"],r={},c={},s={},u={},d=Object(o["v"])(null),l=function e(n,t,o){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,c=t.find((function(e){return e.name===o})),u=n.clipAction(c);u.timeScale=i,s["Robot"][2].isPlaying&&(r=0,setTimeout((function(){e(n,t,o,i,!0,1)}),1e3*s["Robot"][2].duration)),c.isPlaying=!0,a?u.setEffectiveWeight(r).play():(u.setLoop(g["H"]),u.reset().setEffectiveTimeScale(.5).setEffectiveWeight(1).play())},f=function(e,n,t){var o=n.find((function(e){return e.name===t})),i=e.clipAction(o);i.stop()},v=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=e.every((function(e){return!0===u[e]}));if(n){var o=n.every((function(e){return!1===u[e]||void 0===u[e]}));return t&&o}return t},b=function(e){return e.some((function(e){return!0===u[e]}))},p=function(){var e=new g["zb"](r["Robot"].position.x,r["Robot"].position.y,r["Robot"].position.z),n=5;e.y+=n;var t=.18,o=6,i=0,c=new g["zb"];v(["ShiftLeft"])&&(t*=2),v(["KeyW"],["KeyA","KeyS","KeyD"])?(i=180,c.z=-1*t,e.z+=-1*t):v(["KeyA"],["KeyW","KeyS","KeyD"])?(i=-90,c.x=-1*t,e.x+=-1*t):v(["KeyS"],["KeyW","KeyA","KeyD"])?(i=0,c.z=1*t,e.z+=1*t):v(["KeyD"],["KeyW","KeyA","KeyS"])?(i=90,c.x=1*t,e.x+=1*t):v(["KeyW","KeyA"])?(i=-135,c.x=-1*t,c.z=-1*t,e.x+=-1*t,e.z+=-1*t):v(["KeyW","KeyD"])?(i=135,c.x=1*t,c.z=-1*t,e.x+=1*t,e.z+=-1*t):v(["KeyS","KeyA"])?(i=-45,c.x=-1*t,c.z=1*t,e.x+=-1*t,e.z+=1*t):v(["KeyS","KeyD"])&&(i=45,c.x=1*t,c.z=1*t,e.x+=1*t,e.z+=1*t),a.set(e,new g["zb"](0,-1,0));var s=a.intersectObject(r["floor"],!0);return s[0]&&s[0].distance-n<o?(c.y=-s[0].distance+n,{move:c,angle:i}):(c.x=0,c.y=0,c.z=0,{move:c,angle:i})},y=function(){if(c["Robot"]){if(b(["KeyW","KeyA","KeyS","KeyD"])){var e=1;v(["ShiftLeft"])&&(e=2),l(c["Robot"],s["Robot"],"Robot_Running",e)}else f(c["Robot"],s["Robot"],"Robot_Running");b(["Space"])&&l(c["Robot"],s["Robot"],"Robot_Jump",1,!1)}},m=function(e){u[e.code]=!1,y()},w=function(e){u[e.code]=!0,y()};return window.addEventListener("keydown",w),window.addEventListener("keyup",m),Object(o["n"])((function(){var o,a=d.value;e=new g["X"](60,a.clientWidth/a.clientHeight,1,1e3),e.position.set(55,55,55),n.setSize(a.clientWidth,a.clientHeight),a.appendChild(n.domElement);var l=new j["a"];l.load("/peach_castle/scene.gltf",(function(e){var n=e.scene;t.add(n),e.animations.length&&(o=new g["b"](n),o.clipAction(e.animations[0]).play())}),void 0,(function(e){console.error(e)})),l.load("/Robot.gltf",(function(e){var n=e.scene;n.userData.name="Robot",t.add(n),n.position.set(5,12,0),r[n.userData.name]=n,s[n.userData.name]=e.animations,s[n.userData.name].forEach((function(e){e.isPlaying=!1})),c[n.userData.name]=new g["b"](n),c[n.userData.name].addEventListener("finished",(function(e){e.action._clip.isPlaying=!1,console.log("animacja skonczona")}))}),void 0,(function(e){console.error(e)})),l.load("/peach_castle/floor.gltf",(function(e){var n=e.scene;n.userData.name="floor",n.visible=!1,t.add(n),r[n.userData.name]=n}),void 0,(function(e){console.error(e)}));var f=new g["q"](16777215,2236962,1),v=new g["k"](16777215,4);v.position.set(10,10,10),t.add(f,v);var b=new h["a"](e,n.domElement);b.enableDamping=!0,b.dampingFactor=.05,b.screenSpacePanning=!1,b.minDistance=10,b.maxDistance=500;var y=new O["a"](n),m=new x["a"](t,e);y.addPass(m);var w=new z["a"](window.innerWidth*n.getPixelRatio(),window.innerHeight*n.getPixelRatio());y.addPass(w);var K=function(){n.render(t,e)},R=function e(){for(var n in requestAnimationFrame(e),"undefined"!==typeof o&&o.update(i.getDelta()),c)c[n].update(i.getDelta());if(Object.values(u).includes(!0)){var t=p();r["Robot"].position.add(t.move),r["Robot"].rotation.y=t.angle*(Math.PI/180)}b.update(),K()};R()})),Object(o["o"])((function(){window.removeEventListener("keydown",w),window.removeEventListener("keyup",m)})),{camera:e,renderer:n,scene:t,clock:i,raycaster:a,objects:r,mixers:c,animations:s,pressedKeys:u,sceneRef:d,playAnimation:l,stopAnimation:f,testAllKeys:v,testAnyKeys:b,checkKeysState:p,robotRunning:y,keyUp:m,keyDown:w}}};t("0220");K.render=w,K.__scopeId="data-v-549912f1";var R=K,D=Object(o["D"])("data-v-1c1dc04e");Object(o["t"])("data-v-1c1dc04e");var P={class:"container"},S={class:"preloader"},A=Object(o["e"])(" Ładowanie "),E={key:0,class:"popup-wrapper"},W={class:"popup"},k=Object(o["f"])("div",{class:"title"},"Sterowanie",-1),M=Object(o["f"])("div",null,"WASD - chodzenie",-1),L=Object(o["f"])("div",null,"SHIFT - bieganie",-1),_=Object(o["f"])("div",null,"SPACE - skok (w trakcie dopracowania)",-1),C=Object(o["f"])("div",null,"Można także podłaczyć pada (testowane na padach z Xbox 360)",-1);Object(o["q"])();var H=D((function(e,n,t,i,a,r){return Object(o["p"])(),Object(o["c"])("div",P,[Object(o["C"])(Object(o["f"])("div",S,[Object(o["f"])("div",null,[A,Object(o["C"])(Object(o["f"])("span",null,Object(o["y"])(i.loading.loaded)+"/"+Object(o["y"])(i.loading.total),513),[[o["A"],i.loading.total]])]),Object(o["C"])(Object(o["f"])("div",null,Object(o["y"])(i.loading.progress)+"%",513),[[o["A"],i.loading.total]])],512),[[o["A"],i.loading.progress<100]]),i.popup&&100==i.loading.progress?(Object(o["p"])(),Object(o["c"])("div",E,[Object(o["f"])("div",W,[k,M,L,_,C,Object(o["f"])("button",{class:"close",onClick:n[1]||(n[1]=function(e){return i.popup=!1})},"X")])])):Object(o["d"])("",!0),Object(o["f"])("div",{class:["scene",{blur:i.loading.progress<100}],ref:"sceneRef"},null,2)])})),F=t("3191"),I=t.n(F);function T(e,n,t){var i=new g["jb"],a=new g["Cb"]({antialias:!0}),r=new g["X"],c=Object(o["v"])(),s=[],u=new h["a"](r,a.domElement),d=function(){r.aspect=window.innerWidth/window.innerHeight,r.updateProjectionMatrix(),a.setPixelRatio(Math.min(window.devicePixelRatio,2)),a.setSize(window.innerWidth,window.innerHeight)};return Object(o["n"])((function(){r.fov=60,r.aspect=e.value?e.value.clientWidth/e.value.clientHeight:window.innerWidth/window.innerHeight,r.near=1,r.far=1e3,r.position.set(n.x+t.x,n.y+t.y,n.z+t.z),r.updateProjectionMatrix(),a.setSize(e.value.clientWidth,e.value.clientHeight),a.setPixelRatio(Math.min(window.devicePixelRatio,2)),e.value.appendChild(a.domElement),window.addEventListener("resize",d);var o=new I.a;o.showPanel(0),document.body.appendChild(o.dom),u.enableDamping=!0,u.dampingFactor=.05,u.screenSpacePanning=!1,u.minDistance=10,u.maxDistance=500,u.enablePan=!1,u.enableRotate=!1,u.enableZoom=!1,u.target=n;var c=function(){a.render(i,r)},l=function e(){o.begin(),requestAnimationFrame(e),u.update(),s.forEach((function(e){e()})),c(),o.end()};l()})),Object(o["o"])((function(){window.removeEventListener("resize",d)})),{scene:i,renderer:a,camera:r,animateFunctions:s,animation:c,controls:u}}function q(e){Object(o["n"])((function(){var n=new g["q"](16777215,2236962,3.5),t=new g["k"](16777215,3);t.position.set(10,30,10),e.add(n)}))}function B(e,n,t){Object(o["n"])((function(){var o=new O["a"](t),i=new x["a"](e,n);o.addPass(i);var a=new z["a"](window.innerWidth*t.getPixelRatio(),window.innerHeight*t.getPixelRatio());o.addPass(a)}))}function J(e,n,t,i,a){Object(o["n"])((function(){e.load(i,(function(e){var t=e.scene;n.add(t)}),void 0,(function(e){console.error(e)})),e.load(a,(function(e){var o=e.scene;o.userData.name="floor",o.visible=!1,n.add(o),t[o.userData.name]=o}),void 0,(function(e){console.error(e)}))}))}var X=t("1209");function G(e,n,t,i,a,r,c,s,u,d,l,f,v,b,p,y,m,w){var h=new g["hb"],j=new g["i"],O=!1,x=null,z=0,K=function(e,n,t){var o,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=n.find((function(e){return e.name===t})),c=e.clipAction(r);(c.setEffectiveTimeScale(i),a||c.time!=c.getClip().duration||c.reset(),a||c==x)||(O=!0,c.setLoop(g["H"],1),c.setEffectiveWeight(1).reset(),null===(o=x)||void 0===o||o.fadeOut(R(x,c)),x=c);O?x&&x.time/x.getClip().duration>=.75&&(O=!1,c.fadeIn(R(c,x)).reset(),x=c):(c.setEffectiveWeight(1),x=c)},R=function(e,n){var t=e.getClip().duration/e.getEffectiveTimeScale(),o=n.getClip().duration/n.getEffectiveTimeScale();return.25*o>t?t:.25*o},D=function(e,n,t){var o=n.find((function(e){return e.name===t})),i=e.clipAction(o);i.setEffectiveWeight(0)},P=function(){w.value=Object(X["a"])({targets:p.position,easing:"easeOutCirc",duration:1e3,complete:function(){w.value=null},x:t["Robot"].position.x+m.x,y:t["Robot"].position.y+m.y,z:t["Robot"].position.z+m.z}),w.value=Object(X["a"])({targets:b.target,easing:"easeOutCirc",duration:2e3,complete:function(){w.value=null},x:t["Robot"].position.x,y:t["Robot"].position.y,z:t["Robot"].position.z})},S=function(){var e,n=t["Robot"].position.clone(),o=180*t["Robot"].rotation.y/Math.PI,i=W(t["Robot"]),a=i.max.y-i.min.y,r=n.clone();r.y+=a;var s=.18,u=1,l=1.2,v=5,b=o,p=new g["zb"],y=2200==(null===(e=x)||void 0===e?void 0:e.loop),m=f();!c(["ShiftLeft"])&&!d([7])||y||(s*=2),c(["KeyW"],["KeyA","KeyS","KeyD"])||d([12],[13,14,15])?(b=180,p.z=-1*s,r.z+=-1*s-u):c(["KeyA"],["KeyW","KeyS","KeyD"])||d([14],[12,13,15])?(b=-90,p.x=-1*s,r.x+=-1*s-u):c(["KeyS"],["KeyW","KeyA","KeyD"])||d([13],[12,14,15])?(b=0,p.z=1*s,r.z+=1*s+u):c(["KeyD"],["KeyW","KeyA","KeyS"])||d([15],[12,13,14])?(b=90,p.x=1*s,r.x+=1*s+u):c(["KeyW","KeyA"])||d([12,14])?(b=-135,p.x=-1*s,p.z=-1*s,r.x+=-1*s-u,r.z+=-1*s-u):c(["KeyW","KeyD"])||d([12,15])?(b=135,p.x=1*s,p.z=-1*s,r.x+=1*s+u,r.z+=-1*s-u):c(["KeyS","KeyA"])||d([13,14])?(b=-45,p.x=-1*s,p.z=1*s,r.x+=-1*s-u,r.z+=1*s+u):(c(["KeyS","KeyD"])||d([13,15]))&&(b=45,p.x=1*s,p.z=1*s,r.x+=1*s+u,r.z+=1*s+u),m&&(b=m.angle,p.x=m.x*s,p.z=m.z*s,r.x+=m.x*s+(m.x>0?u:-u),r.z+=m.z*s+(m.z>0?u:-u)),P();var w=Math.abs(o-b);y&&w>45&&w<315&&(b=o,p.x=0,p.z=0),h.set(r,new g["zb"](0,-1,0));var j=h.intersectObject(t["floor"],!0),O=Math.abs(i.min.y-n.y),K=j[0]?j[0].distance-a:0,R=!(K>=0);return j[0],j[0]&&Math.abs(K)<l+O&&R?y?(O>=Math.abs(K)?p.y=0:z<Math.abs(K+O)?(p.y=Math.abs(K+O),x&&x.warp(x.timeScale,4*x.timeScale,x.getClip().duration-x.time)):p.y=0,z=Math.abs(K+O),{move:p,angle:b}):(z=0,p.y=-j[0].distance+a,{move:p,angle:b}):j[0]&&K<v&&!R?(p.y=-j[0].distance+a,{move:p,angle:b}):(p.x=0,p.y=0,p.z=0,{move:p,angle:b})},A=function(){if(a["Robot"]){if(s(["KeyW","KeyA","KeyS","KeyD"])||l([12,13,14,15])||f()){var e=1;(c(["ShiftLeft"])||d([7]))&&(e=2),K(a["Robot"],i["Robot"],"Robot_Running",e)}else D(a["Robot"],i["Robot"],"Robot_Running");(s(["Space"])||d([0]))&&(O||K(a["Robot"],i["Robot"],"Robot_Jump",.6,!1))}},E=function(){for(var e in a)a[e].update(j.getDelta());if(Object.values(r).includes(!0)||O||u.value[0]){var n=S();t["Robot"].position.add(n.move),t["Robot"].rotation.y=n.angle*(Math.PI/180)}},W=function(e){for(var n=new g["mb"](e),t={x:1/0,y:1/0,z:1/0},o={x:-1/0,y:-1/0,z:-1/0},i=0;i<n.bones.length;i++){var a=n.bones[i],r=new g["zb"];a.getWorldPosition(r),r.x<t.x&&(t.x=r.x),r.y<t.y&&(t.y=r.y),r.z<t.z&&(t.z=r.z),r.x>o.x&&(o.x=r.x),r.y>o.y&&(o.y=r.y),r.z>o.z&&(o.z=r.z)}return{min:t,max:o}};return Object(o["n"])((function(){e.load(v,(function(e){var o=e.scene;o.userData.name="Robot",o.position.set(y.x,y.y,y.z),n.add(o),t[o.userData.name]=o,i[o.userData.name]=e.animations,a[o.userData.name]=new g["b"](o),a[o.userData.name].addEventListener("finished",(function(e){O=!1,A()})),i[o.userData.name].forEach((function(e){a[o.userData.name].clipAction(e).setEffectiveWeight(0).play()}))}),void 0,(function(e){console.error(e)}))})),{robotRunning:A,toAnimate:E}}function N(e){var n=[],t=Object(o["v"])([]),i=function(n){e[n.code]=!1},a=function(n){e[n.code]=!0},r=function(e){console.log(e.gamepad.id,"podłączony")},c=function(e){console.log(e.gamepad.id,"odłączony")},s=function(){t.value=navigator.getGamepads()},u=function(){n.forEach((function(e){e()}))};window.addEventListener("keydown",a),window.addEventListener("keyup",i),window.addEventListener("gamepadconnected",r),window.addEventListener("gamepaddisconnected",c);var d=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=n.every((function(n){return!0===e[n]}));if(t){var i=t.every((function(n){return!1===e[n]||void 0===e[n]}));return o&&i}return o},l=function(n){return n.some((function(n){return!0===e[n]}))},f=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=e.every((function(e){var n;return null===(n=t.value[0])||void 0===n?void 0:n.buttons[e].pressed}));if(n){var i=n.every((function(e){var n;return!(null!==(n=t.value[0])&&void 0!==n&&n.buttons[e].pressed)}));return o&&i}return o},v=function(){if(t.value[0]){var e,n,o=.3,i=null===(e=t.value[0])||void 0===e?void 0:e.axes[0],a=null===(n=t.value[0])||void 0===n?void 0:n.axes[1],r=180*Math.atan2(a,-i)/Math.PI,c={angle:r-90,x:i,z:a};if(Math.abs(i)>o||Math.abs(a)>o)return c}},b=function(e){return e.some((function(e){var n;return null===(n=t.value[0])||void 0===n?void 0:n.buttons[e].pressed}))};return Object(o["o"])((function(){window.removeEventListener("keydown",a),window.removeEventListener("keyup",i),window.removeEventListener("gamepadconnected",r),window.addEventListener("gamepaddisconnected",c)})),{testAllKeys:d,testAnyKeys:l,keysFunctions:n,checkPressedKeys:u,testAllButtons:f,testAnyButton:b,testAxis:v,checkPads:s,gamepads:t}}function U(e){var n=Object(o["u"])({loaded:0,total:0,progress:0});return Object(o["n"])((function(){e.onProgress=function(e,t,o){n.loaded=t,n.total=o,n.progress=Math.round(t/o*1e4)/100}})),{loading:n}}var Z=t("5f35"),Q={setup:function(){var e=Object(o["v"])(!0),n=new g["zb"](5,11.5,0),t=new g["zb"](2.5,15,25),i=Object(o["v"])(null),a=T(i,n,t),r=a.scene,c=a.renderer,s=a.camera,u=a.animateFunctions,d=a.animation,l=a.controls;q(r),B(r,s,c);var f=new g["G"],v=U(f),b=v.loading,p=new j["a"](f),y={};J(p,r,y,"".concat(Z["publicPath"],"peach_castle/scene.gltf"),"".concat(Z["publicPath"],"peach_castle/floor.gltf"));var m={},w=N(m),h=w.testAllKeys,O=w.testAnyKeys,x=w.keysFunctions,z=w.checkPressedKeys,K=w.testAllButtons,R=w.testAnyButton,D=w.testAxis,P=w.checkPads,S=w.gamepads;u.push(z,P);var A={},E={},W=G(p,r,y,A,E,m,h,O,S,K,R,D,"".concat(Z["publicPath"],"Robot_edited.glb"),l,s,n,t,d),k=W.robotRunning,M=W.toAnimate;return u.push(M),x.push(k),{sceneRef:i,loading:b,popup:e,close:close,camera:s,animations:A,mixers:E}}};t("1a71");Q.render=H,Q.__scopeId="data-v-1c1dc04e";var V=Q,Y=function(e){Object(l["a"])(t,e);var n=Object(f["a"])(t);function t(){return Object(d["a"])(this,t),n.apply(this,arguments)}return t}(b["b"]);Y=Object(v["a"])([Object(b["a"])({components:{Scene:R,NewScene:V}})],Y);var $=Y;$.render=u;var ee=$,ne=[{path:"/",name:"Home",component:ee}],te=Object(s["a"])({history:Object(s["b"])("/brewery-town-public/"),routes:ne}),oe=te,ie=t("5502"),ae=Object(ie["a"])({state:{},mutations:{},actions:{},modules:{}});Object(o["b"])(c).use(ae).use(oe).mount("#app")},fb5c:function(e,n,t){},ff19:function(e,n,t){}});
//# sourceMappingURL=app.2a2a2189.js.map