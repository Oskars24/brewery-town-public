(function(e){function n(n){for(var o,r,c=n[0],s=n[1],u=n[2],l=0,f=[];l<c.length;l++)r=c[l],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&f.push(a[r][0]),a[r]=0;for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o]);d&&d(n);while(f.length)f.shift()();return i.push.apply(i,u||[]),t()}function t(){for(var e,n=0;n<i.length;n++){for(var t=i[n],o=!0,c=1;c<t.length;c++){var s=t[c];0!==a[s]&&(o=!1)}o&&(i.splice(n--,1),e=r(r.s=t[0]))}return e}var o={},a={app:0},i=[];function r(n){if(o[n])return o[n].exports;var t=o[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,r),t.l=!0,t.exports}r.m=e,r.c=o,r.d=function(e,n,t){r.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,n){if(1&n&&(e=r(e)),8&n)return e;if(4&n&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(r.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)r.d(t,o,function(n){return e[n]}.bind(null,o));return t},r.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(n,"a",n),n},r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},r.p="/brewery-town-public/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=n,c=c.slice();for(var u=0;u<c.length;u++)n(c[u]);var d=s;i.push([0,"chunk-vendors"]),t()})({0:function(e,n,t){e.exports=t("cd49")},"0220":function(e,n,t){"use strict";t("ff19")},"5f35":function(e,n,t){e.exports={publicPath:"/brewery-town-public/"}},"67fd":function(e,n,t){},"7de7":function(e,n,t){"use strict";t("67fd")},b3df:function(e,n,t){"use strict";t("fb5c")},cd49:function(e,n,t){"use strict";t.r(n);t("e260"),t("e6cf"),t("cca6"),t("a79d");var o=t("7a23"),a={id:"app"};function i(e,n){var t=Object(o["w"])("router-view");return Object(o["p"])(),Object(o["c"])("div",a,[Object(o["f"])(t)])}t("b3df");const r={};r.render=i;var c=r,s=t("6c02");function u(e,n,t,a,i,r){var c=Object(o["w"])("new-scene");return Object(o["p"])(),Object(o["c"])("div",null,[Object(o["f"])(c)])}var d=t("d4ec"),l=t("262e"),f=t("2caf"),v=t("9ab4"),b=t("ce1f"),p=Object(o["D"])("data-v-549912f1");Object(o["t"])("data-v-549912f1");var y={class:"container"},m={class:"scene",ref:"sceneRef"};Object(o["q"])();var g=p((function(e,n,t,a,i,r){return Object(o["p"])(),Object(o["c"])("div",y,[Object(o["f"])("div",m,null,512)])})),w=(t("a623"),t("7db0"),t("4160"),t("caad"),t("45fc"),t("b0c0"),t("07ac"),t("2532"),t("159b"),t("5a89")),h=t("4721"),j=t("34ad"),O=t("32d9"),x=t("93e9"),K=t("f7dd"),R={setup:function(){var e,n=new w["Db"]({antialias:!0}),t=new w["kb"],a=new w["i"],i=new w["ib"],r={},c={},s={},u={},d=Object(o["v"])(null),l=function e(n,t,o){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,c=t.find((function(e){return e.name===o})),u=n.clipAction(c);u.timeScale=a,s["Robot"][2].isPlaying&&(r=0,setTimeout((function(){e(n,t,o,a,!0,1)}),1e3*s["Robot"][2].duration)),c.isPlaying=!0,i?u.setEffectiveWeight(r).play():(u.setLoop(w["I"]),u.reset().setEffectiveTimeScale(.5).setEffectiveWeight(1).play())},f=function(e,n,t){var o=n.find((function(e){return e.name===t})),a=e.clipAction(o);a.stop()},v=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=e.every((function(e){return!0===u[e]}));if(n){var o=n.every((function(e){return!1===u[e]||void 0===u[e]}));return t&&o}return t},b=function(e){return e.some((function(e){return!0===u[e]}))},p=function(){var e=new w["Ab"](r["Robot"].position.x,r["Robot"].position.y,r["Robot"].position.z),n=5;e.y+=n;var t=.18,o=6,a=0,c=new w["Ab"];v(["ShiftLeft"])&&(t*=2),v(["KeyW"],["KeyA","KeyS","KeyD"])?(a=180,c.z=-1*t,e.z+=-1*t):v(["KeyA"],["KeyW","KeyS","KeyD"])?(a=-90,c.x=-1*t,e.x+=-1*t):v(["KeyS"],["KeyW","KeyA","KeyD"])?(a=0,c.z=1*t,e.z+=1*t):v(["KeyD"],["KeyW","KeyA","KeyS"])?(a=90,c.x=1*t,e.x+=1*t):v(["KeyW","KeyA"])?(a=-135,c.x=-1*t,c.z=-1*t,e.x+=-1*t,e.z+=-1*t):v(["KeyW","KeyD"])?(a=135,c.x=1*t,c.z=-1*t,e.x+=1*t,e.z+=-1*t):v(["KeyS","KeyA"])?(a=-45,c.x=-1*t,c.z=1*t,e.x+=-1*t,e.z+=1*t):v(["KeyS","KeyD"])&&(a=45,c.x=1*t,c.z=1*t,e.x+=1*t,e.z+=1*t),i.set(e,new w["Ab"](0,-1,0));var s=i.intersectObject(r["floor"],!0);return s[0]&&s[0].distance-n<o?(c.y=-s[0].distance+n,{move:c,angle:a}):(c.x=0,c.y=0,c.z=0,{move:c,angle:a})},y=function(){if(c["Robot"]){if(b(["KeyW","KeyA","KeyS","KeyD"])){var e=1;v(["ShiftLeft"])&&(e=2),l(c["Robot"],s["Robot"],"Robot_Running",e)}else f(c["Robot"],s["Robot"],"Robot_Running");b(["Space"])&&l(c["Robot"],s["Robot"],"Robot_Jump",1,!1)}},m=function(e){u[e.code]=!1,y()},g=function(e){u[e.code]=!0,y()};return window.addEventListener("keydown",g),window.addEventListener("keyup",m),Object(o["n"])((function(){var o,i=d.value;e=new w["Y"](60,i.clientWidth/i.clientHeight,1,1e3),e.position.set(55,55,55),n.setSize(i.clientWidth,i.clientHeight),i.appendChild(n.domElement);var l=new j["a"];l.load("/peach_castle/scene.gltf",(function(e){var n=e.scene;t.add(n),e.animations.length&&(o=new w["b"](n),o.clipAction(e.animations[0]).play())}),void 0,(function(e){console.error(e)})),l.load("/Robot.gltf",(function(e){var n=e.scene;n.userData.name="Robot",t.add(n),n.position.set(5,12,0),r[n.userData.name]=n,s[n.userData.name]=e.animations,s[n.userData.name].forEach((function(e){e.isPlaying=!1})),c[n.userData.name]=new w["b"](n),c[n.userData.name].addEventListener("finished",(function(e){e.action._clip.isPlaying=!1,console.log("animacja skonczona")}))}),void 0,(function(e){console.error(e)})),l.load("/peach_castle/floor.gltf",(function(e){var n=e.scene;n.userData.name="floor",n.visible=!1,t.add(n),r[n.userData.name]=n}),void 0,(function(e){console.error(e)}));var f=new w["r"](16777215,2236962,1),v=new w["k"](16777215,4);v.position.set(10,10,10),t.add(f,v);var b=new h["a"](e,n.domElement);b.enableDamping=!0,b.dampingFactor=.05,b.screenSpacePanning=!1,b.minDistance=10,b.maxDistance=500;var y=new O["a"](n),m=new x["a"](t,e);y.addPass(m);var g=new K["a"](window.innerWidth*n.getPixelRatio(),window.innerHeight*n.getPixelRatio());y.addPass(g);var R=function(){n.render(t,e)},A=function e(){for(var n in requestAnimationFrame(e),"undefined"!==typeof o&&o.update(a.getDelta()),c)c[n].update(a.getDelta());if(Object.values(u).includes(!0)){var t=p();r["Robot"].position.add(t.move),r["Robot"].rotation.y=t.angle*(Math.PI/180)}b.update(),R()};A()})),Object(o["o"])((function(){window.removeEventListener("keydown",g),window.removeEventListener("keyup",m)})),{camera:e,renderer:n,scene:t,clock:a,raycaster:i,objects:r,mixers:c,animations:s,pressedKeys:u,sceneRef:d,playAnimation:l,stopAnimation:f,testAllKeys:v,testAnyKeys:b,checkKeysState:p,robotRunning:y,keyUp:m,keyDown:g}}};t("0220");R.render=g,R.__scopeId="data-v-549912f1";var A=R,z=Object(o["D"])("data-v-53e0aa5a");Object(o["t"])("data-v-53e0aa5a");var P={class:"container"},D={class:"preloader"},S=Object(o["e"])(" Ładowanie "),E={key:0,class:"popup-wrapper"},k={class:"popup"},W=Object(o["f"])("div",{class:"title"},"Sterowanie",-1),M=Object(o["f"])("div",null,"WASD - chodzenie",-1),L=Object(o["f"])("div",null,"SHIFT - bieganie",-1),_=Object(o["f"])("div",null,"SPACE - skok (w trakcie dopracowania)",-1),C=Object(o["f"])("div",null,"Można także podłaczyć pada (testowane na padach z Xbox 360)",-1);Object(o["q"])();var I=z((function(e,n,t,a,i,r){return Object(o["p"])(),Object(o["c"])("div",P,[Object(o["C"])(Object(o["f"])("div",D,[Object(o["f"])("div",null,[S,Object(o["C"])(Object(o["f"])("span",null,Object(o["y"])(a.loading.loaded)+"/"+Object(o["y"])(a.loading.total),513),[[o["A"],a.loading.total]])]),Object(o["C"])(Object(o["f"])("div",null,Object(o["y"])(a.loading.progress)+"%",513),[[o["A"],a.loading.total]])],512),[[o["A"],a.loading.progress<100]]),a.popup&&100==a.loading.progress?(Object(o["p"])(),Object(o["c"])("div",E,[Object(o["f"])("div",k,[W,M,L,_,C,Object(o["f"])("button",{class:"close",onClick:n[1]||(n[1]=function(e){return a.popup=!1})},"X")])])):Object(o["d"])("",!0),Object(o["f"])("div",{class:["scene",{blur:a.loading.progress<100}],ref:"sceneRef"},null,2)])})),H=t("3191"),F=t.n(H);function T(e,n,t){var a=new w["kb"],i=new w["Db"]({antialias:!0}),r=new w["Y"],c=Object(o["v"])(),s=[],u=new h["a"](r,i.domElement),d=function(){r.aspect=window.innerWidth/window.innerHeight,r.updateProjectionMatrix(),i.setPixelRatio(Math.min(window.devicePixelRatio,2)),i.setSize(window.innerWidth,window.innerHeight)};return Object(o["n"])((function(){r.fov=60,r.aspect=e.value?e.value.clientWidth/e.value.clientHeight:window.innerWidth/window.innerHeight,r.near=1,r.far=300,r.position.set(n.x+t.x,n.y+t.y,n.z+t.z),r.updateProjectionMatrix(),i.setSize(e.value.clientWidth,e.value.clientHeight),i.setPixelRatio(Math.min(window.devicePixelRatio,2)),e.value.appendChild(i.domElement),a.background=new w["j"](13426943),a.fog=new w["o"](13426943,100,300),window.addEventListener("resize",d);var o=new F.a;o.showPanel(0),document.body.appendChild(o.dom),u.enableDamping=!0,u.dampingFactor=.05,u.screenSpacePanning=!1,u.minDistance=10,u.maxDistance=30,u.maxPolarAngle=75*Math.PI/180,u.enablePan=!1,u.enableZoom=!1,u.target=n;var c=function(){i.render(a,r)},l=function e(){o.begin(),requestAnimationFrame(e),u.update(),s.forEach((function(e){e()})),c(),o.end()};l()})),Object(o["o"])((function(){window.removeEventListener("resize",d)})),{scene:a,renderer:i,camera:r,animateFunctions:s,animation:c,controls:u}}function q(e){Object(o["n"])((function(){var n=new w["r"](16777215,2236962,.5),t=new w["k"](16777215,.5);t.position.set(10,30,10),e.add(n,t)}))}function B(e,n,t){Object(o["n"])((function(){var o=new O["a"](t),a=new x["a"](e,n);o.addPass(a);var i=new K["a"](window.innerWidth*t.getPixelRatio(),window.innerHeight*t.getPixelRatio());o.addPass(i)}))}function J(e,n,t,a,i){Object(o["n"])((function(){e.load(a,(function(e){var t=e.scene;n.add(t)}),void 0,(function(e){console.error(e)})),e.load(i,(function(e){var o=e.scene;o.userData.name="floor",o.visible=!1,n.add(o),t[o.userData.name]=o}),void 0,(function(e){console.error(e)}))}))}var X=t("1209");function Y(e,n,t,a,i,r,c,s,u,d,l,f,v,b,p,y,m,g){var h=new w["ib"],j=new w["i"],O=!1,x=null,K=0,R=function(e,n,t){var o,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=n.find((function(e){return e.name===t})),c=e.clipAction(r);(c.setEffectiveTimeScale(a),i||c.time!=c.getClip().duration||c.reset(),i||c==x)||(O=!0,c.setLoop(w["I"],1),c.setEffectiveWeight(1).reset(),null===(o=x)||void 0===o||o.fadeOut(A(x,c)),x=c);O?x&&x.time/x.getClip().duration>=.75&&(O=!1,c.fadeIn(A(c,x)).reset(),x=c):(c.setEffectiveWeight(1),x=c)},A=function(e,n){var t=e.getClip().duration/e.getEffectiveTimeScale(),o=n.getClip().duration/n.getEffectiveTimeScale();return.25*o>t?t:.25*o},z=function(e,n,t){var o=n.find((function(e){return e.name===t})),a=e.clipAction(o);a.setEffectiveWeight(0)},P=function(){g.value=Object(X["a"])({targets:b.target,easing:"easeOutCirc",duration:2e3,complete:function(){g.value=null},x:t["Robot"].position.x,y:t["Robot"].position.y,z:t["Robot"].position.z})},D=function(e){var n=Math.cos(e*Math.PI/180),t=Math.sin(e*Math.PI/180);return{z:n,x:t}},S=function(){var e,n=t["Robot"].position.clone(),o=180*t["Robot"].rotation.y/Math.PI,a=W(t["Robot"]),i=a.max.y-a.min.y,r=n.clone();r.y+=i;var u=.18,v=1,p=1.2,y=5,m=o,g=new w["Ab"],j=2200==(null===(e=x)||void 0===e?void 0:e.loop),O=f(),R=180*b.getAzimuthalAngle()/Math.PI;!c(["ShiftLeft"])&&!d([7])||j||(u*=2),c(["KeyW"],["KeyA","KeyS","KeyD"])||d([12],[13,14,15])?m=180+R:c(["KeyA"],["KeyW","KeyS","KeyD"])||d([14],[12,13,15])?m=-90+R:c(["KeyS"],["KeyW","KeyA","KeyD"])||d([13],[12,14,15])?m=0+R:c(["KeyD"],["KeyW","KeyA","KeyS"])||d([15],[12,13,14])?m=90+R:c(["KeyW","KeyA"])||d([12,14])?m=-135+R:c(["KeyW","KeyD"])||d([12,15])?m=135+R:c(["KeyS","KeyA"])||d([13,14])?m=-45+R:(c(["KeyS","KeyD"])||d([13,15]))&&(m=45+R),(s(["KeyW","KeyA","KeyS","KeyD"])||l([12,13,14,15])||f())&&(g.x=D(m).x*u,g.z=D(m).z*u,r.x+=D(m).x*u+v,r.z+=D(m).z*u+v),O&&(m=O.angle+R,g.x=O.x*u,g.z=O.z*u,r.x+=O.x*u+(O.x>0?v:-v),r.z+=O.z*u+(O.z>0?v:-v)),P();var A=Math.abs(o-m);j&&A>45&&A<315&&(m=o,g.x=0,g.z=0),h.set(r,new w["Ab"](0,-1,0));var z=h.intersectObject(t["floor"],!0),S=Math.abs(a.min.y-n.y),E=z[0]?z[0].distance-i:0,k=!(E>=0);return z[0]&&Math.abs(E)<p+S&&k?j?(S>=Math.abs(E)?g.y=0:K<Math.abs(E+S)?(g.y=Math.abs(E+S),x&&x.warp(x.timeScale,4*x.timeScale,x.getClip().duration-x.time)):g.y=0,K=Math.abs(E+S),{move:g,angle:m}):(K=0,g.y=-z[0].distance+i,{move:g,angle:m}):z[0]&&E<y&&!k?(g.y=-z[0].distance+i,{move:g,angle:m}):(g.x=0,g.y=0,g.z=0,{move:g,angle:m})},E=function(){if(i["Robot"]){if(s(["KeyW","KeyA","KeyS","KeyD"])||l([12,13,14,15])||f()){var e=1;(c(["ShiftLeft"])||d([7]))&&(e=2),R(i["Robot"],a["Robot"],"Robot_Running",e)}else z(i["Robot"],a["Robot"],"Robot_Running");(s(["Space"])||d([0]))&&(O||R(i["Robot"],a["Robot"],"Robot_Jump",.6,!1))}},k=function(){for(var e in i)i[e].update(j.getDelta());if(Object.values(r).includes(!0)||O||u.value[0]){var n=S();t["Robot"].position.add(n.move),t["Robot"].rotation.y=n.angle*(Math.PI/180)}},W=function(e){for(var n=new w["nb"](e),t={x:1/0,y:1/0,z:1/0},o={x:-1/0,y:-1/0,z:-1/0},a=0;a<n.bones.length;a++){var i=n.bones[a],r=new w["Ab"];i.getWorldPosition(r),r.x<t.x&&(t.x=r.x),r.y<t.y&&(t.y=r.y),r.z<t.z&&(t.z=r.z),r.x>o.x&&(o.x=r.x),r.y>o.y&&(o.y=r.y),r.z>o.z&&(o.z=r.z)}return{min:t,max:o}};return Object(o["n"])((function(){e.load(v,(function(e){var o=e.scene;o.userData.name="Robot",o.position.set(y.x,y.y,y.z),n.add(o),t[o.userData.name]=o,a[o.userData.name]=e.animations,i[o.userData.name]=new w["b"](o),i[o.userData.name].addEventListener("finished",(function(e){O=!1,E()})),a[o.userData.name].forEach((function(e){i[o.userData.name].clipAction(e).setEffectiveWeight(0).play()}))}),void 0,(function(e){console.error(e)}))})),{robotRunning:E,toAnimate:k}}function G(e){var n=[],t=Object(o["v"])([]),a=function(n){e[n.code]=!1},i=function(n){e[n.code]=!0},r=function(e){console.log(e.gamepad.id,"podłączony")},c=function(e){console.log(e.gamepad.id,"odłączony")},s=function(){t.value=navigator.getGamepads()},u=function(){n.forEach((function(e){e()}))};window.addEventListener("keydown",i),window.addEventListener("keyup",a),window.addEventListener("gamepadconnected",r),window.addEventListener("gamepaddisconnected",c);var d=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=n.every((function(n){return!0===e[n]}));if(t){var a=t.every((function(n){return!1===e[n]||void 0===e[n]}));return o&&a}return o},l=function(n){return n.some((function(n){return!0===e[n]}))},f=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=e.every((function(e){var n;return null===(n=t.value[0])||void 0===n?void 0:n.buttons[e].pressed}));if(n){var a=n.every((function(e){var n;return!(null!==(n=t.value[0])&&void 0!==n&&n.buttons[e].pressed)}));return o&&a}return o},v=function(){if(t.value[0]){var e,n,o=.3,a=null===(e=t.value[0])||void 0===e?void 0:e.axes[0],i=null===(n=t.value[0])||void 0===n?void 0:n.axes[1],r=180*Math.atan2(i,-a)/Math.PI,c={angle:r-90,x:a,z:i};if(Math.abs(a)>o||Math.abs(i)>o)return c}},b=function(e){return e.some((function(e){var n;return null===(n=t.value[0])||void 0===n?void 0:n.buttons[e].pressed}))};return Object(o["o"])((function(){window.removeEventListener("keydown",i),window.removeEventListener("keyup",a),window.removeEventListener("gamepadconnected",r),window.addEventListener("gamepaddisconnected",c)})),{testAllKeys:d,testAnyKeys:l,keysFunctions:n,checkPressedKeys:u,testAllButtons:f,testAnyButton:b,testAxis:v,checkPads:s,gamepads:t}}function N(e){var n=Object(o["u"])({loaded:0,total:0,progress:0});return Object(o["n"])((function(){e.onProgress=function(e,t,o){n.loaded=t,n.total=o,n.progress=Math.round(t/o*1e4)/100}})),{loading:n}}var U=t("5f35"),Z={setup:function(){var e=Object(o["v"])(!1),n=new w["Ab"](180,28,180),t=new w["Ab"](2.5,15,25),a=Object(o["v"])(null),i=T(a,n,t),r=i.scene,c=i.renderer,s=i.camera,u=i.animateFunctions,d=i.animation,l=i.controls;q(r),B(r,s,c);var f=new w["H"],v=N(f),b=v.loading,p=new j["a"](f),y={};J(p,r,y,"".concat(U["publicPath"],"islands/islands.gltf"),"".concat(U["publicPath"],"islands/islands_physics.gltf"));var m={},g=G(m),h=g.testAllKeys,O=g.testAnyKeys,x=g.keysFunctions,K=g.checkPressedKeys,R=g.testAllButtons,A=g.testAnyButton,z=g.testAxis,P=g.checkPads,D=g.gamepads;u.push(K,P);var S={},E={},k=Y(p,r,y,S,E,m,h,O,D,R,A,z,"".concat(U["publicPath"],"Robot_edited.glb"),l,s,n,t,d),W=k.robotRunning,M=k.toAnimate;return u.push(M),x.push(W),{sceneRef:a,loading:b,popup:e,close:close,camera:s,animations:S,mixers:E}}};t("7de7");Z.render=I,Z.__scopeId="data-v-53e0aa5a";var Q=Z,V=function(e){Object(l["a"])(t,e);var n=Object(f["a"])(t);function t(){return Object(d["a"])(this,t),n.apply(this,arguments)}return t}(b["b"]);V=Object(v["a"])([Object(b["a"])({components:{Scene:A,NewScene:Q}})],V);var $=V;$.render=u;var ee=$,ne=[{path:"/",name:"Home",component:ee}],te=Object(s["a"])({history:Object(s["b"])("/brewery-town-public/"),routes:ne}),oe=te,ae=t("5502"),ie=Object(ae["a"])({state:{},mutations:{},actions:{},modules:{}});Object(o["b"])(c).use(ie).use(oe).mount("#app")},fb5c:function(e,n,t){},ff19:function(e,n,t){}});
//# sourceMappingURL=app.754a718f.js.map